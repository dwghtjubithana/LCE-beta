openapi: 3.0.3
info:
  title: LCE API
  version: 0.1.0
  description: API contract for LCE-beta.
servers: []
components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  schemas:
    ErrorResponse:
      type: object
      properties:
        code:
          type: string
        message:
          type: string
        fieldErrors:
          type: object
      required:
        - code
        - message
    AuthUser:
      type: object
      properties:
        id:
          type: integer
        uuid:
          type: string
        email:
          type: string
          nullable: true
        phone:
          type: string
          nullable: true
        username:
          type: string
        role:
          type: string
        status:
          type: string
    AuthResponse:
      type: object
      properties:
        status:
          type: string
          example: success
        token:
          type: string
        expires_in:
          type: integer
        user:
          $ref: '#/components/schemas/AuthUser'
    Company:
      type: object
      properties:
        id:
          type: integer
        uuid:
          type: string
        owner_user_id:
          type: integer
        company_name:
          type: string
        sector:
          type: string
        experience:
          type: string
          nullable: true
        contact:
          type: object
          nullable: true
        bluewave_status:
          type: boolean
        current_score:
          type: integer
        verification_level:
          type: string
        created_at:
          type: string
        updated_at:
          type: string
    Document:
      type: object
      properties:
        id:
          type: integer
        uuid:
          type: string
        company_id:
          type: integer
        category_selected:
          type: string
        detected_type:
          type: string
          nullable: true
        status:
          type: string
        color:
          type: string
          description: Status color indicator (Grijs, Blauw, Groen, Rood, Oranje)
        expiry_date:
          type: string
          nullable: true
        source_file_url:
          type: string
        original_filename:
          type: string
        created_at:
          type: string
        updated_at:
          type: string
    AuditLog:
      type: object
      properties:
        id:
          type: integer
        actor_user_id:
          type: integer
          nullable: true
        action:
          type: string
        target_type:
          type: string
          nullable: true
        target_id:
          type: integer
          nullable: true
        meta:
          type: object
          nullable: true
        created_at:
          type: string
        updated_at:
          type: string
    ComplianceRule:
      type: object
      properties:
        id:
          type: integer
        document_type:
          type: string
        sector_applicability:
          type: array
          items:
            type: string
          nullable: true
        required_keywords:
          type: array
          items:
            type: string
          nullable: true
        max_age_months:
          type: integer
          nullable: true
        constraints:
          type: object
          nullable: true
        created_at:
          type: string
        updated_at:
          type: string
    AdminUser:
      type: object
      properties:
        id:
          type: integer
        uuid:
          type: string
        username:
          type: string
        email:
          type: string
          nullable: true
        phone:
          type: string
          nullable: true
        app_role:
          type: string
        status:
          type: string
        plan:
          type: string
        plan_status:
          type: string
        created_at:
          type: string
        updated_at:
          type: string
    Tender:
      type: object
      properties:
        id:
          type: integer
        title:
          type: string
        project:
          type: string
          nullable: true
        date:
          type: string
          nullable: true
        client:
          type: string
          nullable: true
        details_url:
          type: string
          nullable: true
        attachments:
          type: array
          items:
            type: string
          nullable: true
        description:
          type: string
          nullable: true
        created_at:
          type: string
        updated_at:
          type: string
    Notification:
      type: object
      properties:
        id:
          type: integer
        user_id:
          type: integer
        company_id:
          type: integer
          nullable: true
        document_id:
          type: integer
          nullable: true
        type:
          type: string
        channel:
          type: string
        sent_at:
          type: string
          nullable: true
        created_at:
          type: string
        updated_at:
          type: string
    Health:
      type: object
      properties:
        app_env:
          type: string
        app_version:
          type: string
        queue_connection:
          type: string
        last_tender_import_at:
          type: string
          nullable: true
        last_notifications_sent_at:
          type: string
          nullable: true
    Metrics:
      type: object
      properties:
        total_users:
          type: integer
        total_companies:
          type: integer
        total_documents:
          type: integer
        documents_by_status:
          type: object
        avg_processing_seconds:
          type: integer
          nullable: true
  responses:
    ValidationError:
      description: Validation error
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
    Unauthorized:
      description: Unauthorized
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
    Forbidden:
      description: Forbidden
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
    NotFound:
      description: Not found
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
    ServerError:
      description: Server error
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
    Conflict:
      description: Conflict
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
paths:
  /api/auth/register:
    post:
      summary: Register a user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                phone:
                  type: string
                password:
                  type: string
                username:
                  type: string
              required:
                - password
      responses:
        '201':
          description: Registered
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthResponse'
        '422':
          $ref: '#/components/responses/ValidationError'
        '500':
          $ref: '#/components/responses/ServerError'
  /api/auth/login:
    post:
      summary: Login a user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                phone:
                  type: string
                password:
                  type: string
              required:
                - password
      responses:
        '200':
          description: Logged in
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '422':
          $ref: '#/components/responses/ValidationError'
        '500':
          $ref: '#/components/responses/ServerError'
  /api/auth/me:
    get:
      summary: Get current user
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Current user
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  user:
                    $ref: '#/components/schemas/AuthUser'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/ServerError'
  /api/auth/logout:
    post:
      summary: Logout current user
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Logged out
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  message:
                    type: string
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/ServerError'
  /api/companies:
    post:
      summary: Create company
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                company_name:
                  type: string
                sector:
                  type: string
                experience:
                  type: string
                contact:
                  type: object
              required:
                - company_name
                - sector
      responses:
        '201':
          description: Company created
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  company:
                    $ref: '#/components/schemas/Company'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
        '500':
          $ref: '#/components/responses/ServerError'
  /api/companies/me:
    get:
      summary: Get current user's company
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Company
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  company:
                    $ref: '#/components/schemas/Company'
        '404':
          $ref: '#/components/responses/NotFound'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/ServerError'
  /api/companies/{id}:
    get:
      summary: Get company by id (owner only)
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Company
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  company:
                    $ref: '#/components/schemas/Company'
        '404':
          $ref: '#/components/responses/NotFound'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/ServerError'
    patch:
      summary: Update company (owner only)
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                company_name:
                  type: string
                sector:
                  type: string
                experience:
                  type: string
                contact:
                  type: object
                bluewave_status:
                  type: boolean
                verification_level:
                  type: string
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  company:
                    $ref: '#/components/schemas/Company'
        '404':
          $ref: '#/components/responses/NotFound'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
        '500':
          $ref: '#/components/responses/ServerError'
  /api/companies/{id}/dashboard:
    get:
      summary: Get company dashboard score
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Dashboard score
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  current_score:
                    type: integer
                  score_color:
                    type: string
                  required_documents:
                    type: array
                    items:
                      type: object
                      properties:
                        type:
                          type: string
                        status:
                          type: string
        '404':
          $ref: '#/components/responses/NotFound'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/ServerError'
  /api/companies/{id}/profile.pdf:
    get:
      summary: Download company profile PDF
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: PDF file
          content:
            application/pdf: {}
        '404':
          $ref: '#/components/responses/NotFound'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/ServerError'
  /api/documents/upload:
    post:
      summary: Upload a document
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                file:
                  type: string
                  format: binary
                category_selected:
                  type: string
                company_id:
                  type: integer
                ocr_confidence:
                  type: number
              required:
                - file
                - category_selected
      responses:
        '201':
          description: Document created
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  document:
                    type: object
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
        '500':
          $ref: '#/components/responses/ServerError'
  /api/documents/upload/bulk:
    post:
      summary: Bulk upload documents
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                files:
                  type: array
                  items:
                    type: string
                    format: binary
                category_selected:
                  type: string
                company_id:
                  type: integer
              required:
                - files
                - category_selected
      responses:
        '201':
          description: Bulk upload queued
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  results:
                    type: array
                    items:
                      type: object
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '422':
          $ref: '#/components/responses/ValidationError'
        '500':
          $ref: '#/components/responses/ServerError'
  /api/documents/{id}:
    get:
      summary: Get document by id
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Document
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  document:
                    $ref: '#/components/schemas/Document'
        '404':
          $ref: '#/components/responses/NotFound'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/ServerError'
  /api/companies/{id}/documents:
    get:
      summary: List documents for a company
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Documents list
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  documents:
                    type: array
                    items:
                      $ref: '#/components/schemas/Document'
        '404':
          $ref: '#/components/responses/NotFound'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/ServerError'
  /api/documents/{id}/summary:
    get:
      summary: Download summary PDF
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: PDF file
          content:
            application/pdf: {}
        '404':
          $ref: '#/components/responses/NotFound'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/ServerError'
  /api/documents/{id}/reprocess:
    post:
      summary: Reprocess a document
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Reprocess queued
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  document:
                    type: object
        '404':
          $ref: '#/components/responses/NotFound'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/ServerError'
  /api/tenders:
    get:
      summary: List tenders (gated fields for non-Business)
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Tender list
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  tenders:
                    type: array
                    items:
                      type: object
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/ServerError'
  /api/tenders/{id}:
    get:
      summary: Get tender by id (gated fields for non-Business)
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Tender
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  tender:
                    type: object
        '404':
          $ref: '#/components/responses/NotFound'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/ServerError'
  /api/admin/compliance-rules:
    get:
      summary: List compliance rules (admin only)
      security:
        - bearerAuth: []
      parameters:
        - name: search
          in: query
          required: false
          schema:
            type: string
        - name: limit
          in: query
          required: false
          schema:
            type: integer
            default: 50
        - name: page
          in: query
          required: false
          schema:
            type: integer
            default: 1
      responses:
        '200':
          description: Compliance rules
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  rules:
                    type: array
                    items:
                      $ref: '#/components/schemas/ComplianceRule'
                  meta:
                    type: object
                    properties:
                      page:
                        type: integer
                      per_page:
                        type: integer
                      total:
                        type: integer
                      total_pages:
                        type: integer
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/ServerError'
    post:
      summary: Create compliance rule (admin only)
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                document_type:
                  type: string
                sector_applicability:
                  type: array
                  items:
                    type: string
                required_keywords:
                  type: array
                  items:
                    type: string
                max_age_months:
                  type: integer
                constraints:
                  type: object
      responses:
        '201':
          description: Compliance rule created
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  rule:
                    $ref: '#/components/schemas/ComplianceRule'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
        '500':
          $ref: '#/components/responses/ServerError'
  /api/admin/compliance-rules/{id}:
    patch:
      summary: Update compliance rule (admin only)
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                document_type:
                  type: string
                sector_applicability:
                  type: array
                  items:
                    type: string
                required_keywords:
                  type: array
                  items:
                    type: string
                max_age_months:
                  type: integer
                constraints:
                  type: object
      responses:
        '200':
          description: Compliance rule updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  rule:
                    $ref: '#/components/schemas/ComplianceRule'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '422':
          $ref: '#/components/responses/ValidationError'
        '500':
          $ref: '#/components/responses/ServerError'
    delete:
      summary: Delete compliance rule (admin only)
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Compliance rule deleted
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  message:
                    type: string
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/ServerError'
  /api/admin/users:
    get:
      summary: List users (admin only)
      security:
        - bearerAuth: []
      parameters:
        - name: search
          in: query
          required: false
          schema:
            type: string
        - name: limit
          in: query
          required: false
          schema:
            type: integer
            default: 20
        - name: page
          in: query
          required: false
          schema:
            type: integer
            default: 1
      responses:
        '200':
          description: Users list
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  users:
                    type: array
                    items:
                      $ref: '#/components/schemas/AdminUser'
                  meta:
                    type: object
                    properties:
                      page:
                        type: integer
                      per_page:
                        type: integer
                      total:
                        type: integer
                      total_pages:
                        type: integer
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/ServerError'
  /api/admin/users/{id}:
    patch:
      summary: Update user role/plan/status (admin only)
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                app_role:
                  type: string
                  enum: [user, admin]
                status:
                  type: string
                  enum: [ACTIVE, SUSPENDED]
                plan:
                  type: string
                  enum: [FREE, PRO, BUSINESS]
                plan_status:
                  type: string
                  enum: [ACTIVE, PENDING_PAYMENT, EXPIRED]
      responses:
        '200':
          description: User updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  user:
                    $ref: '#/components/schemas/AdminUser'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '422':
          $ref: '#/components/responses/ValidationError'
        '500':
          $ref: '#/components/responses/ServerError'
  /api/admin/tenders:
    get:
      summary: List tenders (admin only)
      security:
        - bearerAuth: []
      parameters:
        - name: search
          in: query
          required: false
          schema:
            type: string
        - name: limit
          in: query
          required: false
          schema:
            type: integer
            default: 20
        - name: page
          in: query
          required: false
          schema:
            type: integer
            default: 1
      responses:
        '200':
          description: Tender list
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  tenders:
                    type: array
                    items:
                      $ref: '#/components/schemas/Tender'
                  meta:
                    type: object
                    properties:
                      page:
                        type: integer
                      per_page:
                        type: integer
                      total:
                        type: integer
                      total_pages:
                        type: integer
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/ServerError'
    post:
      summary: Create tender (admin only)
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                title:
                  type: string
                project:
                  type: string
                date:
                  type: string
                client:
                  type: string
                details_url:
                  type: string
                attachments:
                  type: array
                  items:
                    type: string
                description:
                  type: string
      responses:
        '201':
          description: Tender created
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  tender:
                    $ref: '#/components/schemas/Tender'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
        '500':
          $ref: '#/components/responses/ServerError'
  /api/admin/tenders/{id}:
    patch:
      summary: Update tender (admin only)
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                title:
                  type: string
                project:
                  type: string
                date:
                  type: string
                client:
                  type: string
                details_url:
                  type: string
                attachments:
                  type: array
                  items:
                    type: string
                description:
                  type: string
      responses:
        '200':
          description: Tender updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  tender:
                    $ref: '#/components/schemas/Tender'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '422':
          $ref: '#/components/responses/ValidationError'
        '500':
          $ref: '#/components/responses/ServerError'
    delete:
      summary: Delete tender (admin only)
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Tender deleted
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  message:
                    type: string
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/ServerError'
  /api/admin/notifications:
    get:
      summary: List notifications (admin only)
      security:
        - bearerAuth: []
      parameters:
        - name: search
          in: query
          required: false
          schema:
            type: string
        - name: status
          in: query
          required: false
          schema:
            type: string
            enum: [pending, sent]
        - name: limit
          in: query
          required: false
          schema:
            type: integer
            default: 20
        - name: page
          in: query
          required: false
          schema:
            type: integer
            default: 1
      responses:
        '200':
          description: Notifications
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  notifications:
                    type: array
                    items:
                      $ref: '#/components/schemas/Notification'
                  meta:
                    type: object
                    properties:
                      page:
                        type: integer
                      per_page:
                        type: integer
                      total:
                        type: integer
                      total_pages:
                        type: integer
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/ServerError'
  /api/admin/notifications/{id}/resend:
    post:
      summary: Resend notification (admin only)
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Notification resent
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  notification:
                    $ref: '#/components/schemas/Notification'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/ServerError'
  /api/admin/notifications/{id}/mark-sent:
    post:
      summary: Mark notification sent (admin only)
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                sent_at:
                  type: string
      responses:
        '200':
          description: Notification updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  notification:
                    $ref: '#/components/schemas/Notification'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/ServerError'
  /api/admin/notifications/mark-sent:
    post:
      summary: Mark notifications sent in bulk (admin only)
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                ids:
                  type: array
                  items:
                    type: integer
                status:
                  type: string
                  enum: [pending]
                sent_at:
                  type: string
      responses:
        '200':
          description: Bulk update result
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  updated:
                    type: integer
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
        '500':
          $ref: '#/components/responses/ServerError'
  /api/admin/health:
    get:
      summary: Get system health (admin only)
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Health summary
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  health:
                    $ref: '#/components/schemas/Health'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/ServerError'
  /api/admin/metrics:
    get:
      summary: Get metrics summary (admin only)
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Metrics summary
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  metrics:
                    $ref: '#/components/schemas/Metrics'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/ServerError'
  /api/admin/gemini/health:
    get:
      summary: Test Gemini connection (admin only)
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Gemini health result
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  result:
                    type: object
                    properties:
                      status:
                        type: string
                      message:
                        type: string
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/ServerError'
  /api/admin/audit-logs:
    get:
      summary: List audit logs (admin only)
      security:
        - bearerAuth: []
      parameters:
        - name: search
          in: query
          required: false
          schema:
            type: string
        - name: limit
          in: query
          required: false
          schema:
            type: integer
            default: 20
        - name: page
          in: query
          required: false
          schema:
            type: integer
            default: 1
      responses:
        '200':
          description: Audit log list
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  logs:
                    type: array
                    items:
                      $ref: '#/components/schemas/AuditLog'
                  meta:
                    type: object
                    properties:
                      page:
                        type: integer
                      per_page:
                        type: integer
                      total:
                        type: integer
                      total_pages:
                        type: integer
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/ServerError'
